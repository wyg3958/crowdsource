<form name="pledgingForm.form" class="pledging-form" novalidate>

    <div class="finance">

        <div class="alert-box notification push" ng-class="pledgingForm.getNotification().type" ng-show="pledgingForm.getNotification() != null">
            {{ pledgingForm.getNotification().message }}
        </div>

        <div class="general-error alert-box alert push" ng-messages="pledgingForm.generalErrors" ng-if="pledgingForm.generalErrors">
            <span ng-message="remote_pledge_goal_exceeded">
                Das Projekt wurde mittlerweile von anderen Benutzern finanziert und deine Finanzierung hätte den Finanzierungsbedarf des Projekts überschritten.
                Die Projektdaten wurden soeben aktualisiert und wir bitten dich einen neuen Finanzierungsbetrag einzugeben.
            </span>
            <span ng-message="remote_project_already_fully_pledged">
                Das Projekt wurde mittlerweile von anderen Benutzern vollständig finanziert. Ein Finanzieren ist leider nicht mehr möglich.
            </span>
            <span ng-message="remote_user_budget_exceeded">Dein Budget reicht nicht aus. Bitte versuche es erneut</span>
            <span ng-message="remote_no_financing_round_currently_active">
                Die Finanzierungsrunde ist mittlerweile leider beendet.
                Das Finanzieren ist erst wieder möglich, wenn die nächste Runde gestartet wurde.
            </span>
            <span ng-message="remote_unknown">Es ist ein Fehler aufgetreten. Bitte versuche es erneut.</span>
        </div>

        <div class="finance__section">
            <range-slider ng-model="pledgingForm.pledge.amount" start="0" end="{{ pledgingForm.getPledgableAmount() }}"
                          disabled="pledgingForm.getPledgableAmount() == 0"></range-slider>

            <ul class="finance__ul">
                <li class="finance__li-important form-controls-amount">
                    <label form-group="amount">
                        <input class="finance__input" type="number" name="amount" ng-model="pledgingForm.pledge.amount"
                               ng-disabled="pledgingForm.getPledgableAmount() == 0"
                               required min="1" ng-max="pledgingForm.getPledgableAmount()" ng-pattern="/^[0-9]+$/">

                        <span class="finance__subtitle" form-label-valid="amount">Dein Investment</span>
                        <span class="finance__subtitle" form-label-invalid="amount" ng-messages="pledgingForm.form.amount.$error">
                            <span ng-message="required">Bitte gib deinen gewünschten Finanzierungsbetrag ein</span>
                            <span ng-message="min">Der Finanzierungsbetrag muss größer 0 sein</span>
                            <span ng-message="max">Dein Finanzierungsbetrag ist zu hoch</span>
                            <span ng-message="number">Bitte gib nur Zahlen ein</span>
                            <span ng-message="pattern">Bitte gib nur Zahlen ein</span>
                        </span>
                    </label>
                </li>
                <li class="right  finance__li-important pledgable-amount">
                    ${{ pledgingForm.getPledgableAmount() | number }}
                </li>
            </ul>
        </div>
        <div class="finance__section">
            <ul class="finance__ul">
                <li class="finance__li">
                    <span class="pledged-amount">${{ pledgingForm.project.pledgedAmount + pledgingForm.pledge.amount | number }}</span> /
                    <span class="pledge-goal">${{ pledgingForm.project.pledgeGoal | number }}</span>
                    <span class="finance__subtitle">Finanzierung</span>
                </li>
                <li class="finance__li">
                    <span class="budget">${{ pledgingForm.user.budget - pledgingForm.pledge.amount | number }}</span>
                    <span class="finance__subtitle">Dein Budget</span>
                </li>
                <li class="finance__li--cta">
                    <button class="finance__btn crwd-success radius shadow" ng-click="pledgingForm.pledgeProject()"
                            ng-disabled="pledgingForm.form.$invalid || pledgingForm.saving">

                        {{ pledgingForm.saving ? 'Bitte warten...' : 'Jetzt finanzieren' }}
                    </button>
                </li>
            </ul>
        </div>
    </div>
</form>
